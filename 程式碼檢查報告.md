# ç¨‹å¼ç¢¼å…¨é¢æª¢æŸ¥å ±å‘Š

## ğŸ“‹ æª¢æŸ¥æ—¥æœŸ
2025å¹´1æœˆ

## ğŸ” ç™¼ç¾çš„å•é¡Œèˆ‡æ”¹é€²å»ºè­°

### ğŸ”´ é«˜å„ªå…ˆç´šå•é¡Œï¼ˆéœ€è¦ç«‹å³ä¿®å¾©ï¼‰

#### 1. **é‡è¤‡çš„ Supabase é…ç½®ï¼ˆå¤šè™•ç¡¬ç·¨ç¢¼ï¼‰**
**å•é¡Œï¼š** Supabase URL å’Œ API Key åœ¨å¤šå€‹æª”æ¡ˆä¸­é‡è¤‡å®šç¾©
- `property-detail.html` (ç¬¬469-470è¡Œ)ï¼šç¡¬ç·¨ç¢¼ `SUPABASE_URL_VALUE` å’Œ `SUPABASE_ANON_KEY_VALUE`
- `supabase-data-loader.js` (ç¬¬5-6è¡Œ)ï¼šç¡¬ç·¨ç¢¼ `SUPABASE_URL` å’Œ `SUPABASE_ANON_KEY`
- `property-admin-db.html` (ç¬¬1748-1749è¡Œ)ï¼šç¡¬ç·¨ç¢¼ Supabase é…ç½®
- `server.js` (ç¬¬16-17è¡Œ)ï¼šç¡¬ç·¨ç¢¼ Supabase é…ç½®
- `import-properties-to-supabase.js` (ç¬¬9-10è¡Œ)ï¼šç¡¬ç·¨ç¢¼ Supabase é…ç½®

**å½±éŸ¿ï¼š**
- é…ç½®è®Šæ›´æ™‚éœ€è¦ä¿®æ”¹å¤šå€‹æª”æ¡ˆ
- å®¹æ˜“å‡ºç¾ä¸ä¸€è‡´
- ç¶­è­·å›°é›£

**å»ºè­°ï¼š**
- çµ±ä¸€ä½¿ç”¨ `supabase-config.js` ä¸­çš„ `SUPABASE_CONFIG`
- ç§»é™¤æ‰€æœ‰ç¡¬ç·¨ç¢¼çš„é…ç½®
- ä½¿ç”¨ `createSupabaseClient()` çµ±ä¸€åˆå§‹åŒ–

---

#### 2. **Supabase å®¢æˆ¶ç«¯åˆå§‹åŒ–ä¸ä¸€è‡´ï¼ˆæœªä½¿ç”¨å–®ä¾‹æ¨¡å¼ï¼‰**
**å•é¡Œï¼š** å¤šå€‹æª”æ¡ˆå„è‡ªå‰µå»º Supabase å®¢æˆ¶ç«¯ï¼Œå¯èƒ½å°è‡´å¤šå€‹å¯¦ä¾‹
- `property-detail.html` (ç¬¬530è¡Œ)ï¼šç›´æ¥å‰µå»ºï¼Œæœªä½¿ç”¨å–®ä¾‹
- `property-admin-db.html` (ç¬¬1758è¡Œ)ï¼šç›´æ¥å‰µå»ºï¼Œæœªæª¢æŸ¥å…¨åŸŸå¯¦ä¾‹
- `supabase-data-loader.js` (ç¬¬109è¡Œ)ï¼šç›´æ¥å‰µå»ºï¼Œæœªä½¿ç”¨çµ±ä¸€å‡½æ•¸

**å½±éŸ¿ï¼š**
- å¯èƒ½å‡ºç¾ "Multiple GoTrueClient instances" è­¦å‘Š
- è³‡æºæµªè²»
- è¡Œç‚ºä¸ä¸€è‡´

**å»ºè­°ï¼š**
- çµ±ä¸€ä½¿ç”¨ `createSupabaseClient()` å‡½æ•¸
- å¯¦ç¾å–®ä¾‹æ¨¡å¼ï¼Œæª¢æŸ¥ `window.supabaseClient` æ˜¯å¦å­˜åœ¨
- æ‰€æœ‰æª”æ¡ˆéƒ½ä½¿ç”¨çµ±ä¸€çš„åˆå§‹åŒ–æ–¹å¼

---

#### 3. **é‡è¤‡çš„å‡½æ•¸å®šç¾©ï¼ˆformatAddressForDisplayï¼‰**
**å•é¡Œï¼š** `formatAddressForDisplay` å‡½æ•¸åœ¨å¤šå€‹æª”æ¡ˆä¸­é‡è¤‡å®šç¾©
- `property-detail.html` (ç¬¬473-505è¡Œ)ï¼šå®Œæ•´å®šç¾©
- `supabase-data-loader.js` (ç¬¬12-65è¡Œ)ï¼šå®Œæ•´å®šç¾©ï¼ˆä¸¦æš´éœ²åˆ° `window.formatAddressForDisplay`ï¼‰
- `pagination-system.js`ï¼šå¯èƒ½ä¹Ÿæœ‰é¡ä¼¼é‚è¼¯

**å½±éŸ¿ï¼š**
- ä»£ç¢¼é‡è¤‡
- ç¶­è­·å›°é›£ï¼ˆä¿®æ”¹éœ€è¦åŒæ­¥å¤šè™•ï¼‰
- å¯èƒ½å‡ºç¾ä¸ä¸€è‡´çš„è¡Œç‚º

**å»ºè­°ï¼š**
- å°‡ `formatAddressForDisplay` ç§»åˆ° `modules/data-entry/manager.js` æˆ–æ–°å»º `modules/utils/address-formatter.js`
- æ‰€æœ‰æª”æ¡ˆçµ±ä¸€å¼•ç”¨åŒä¸€å€‹å‡½æ•¸
- ç¢ºä¿é‚è¼¯ä¸€è‡´ï¼ˆç‰¹åˆ¥æ˜¯æ¨“å±¤è³‡è¨Šä¿ç•™çš„é‚è¼¯ï¼‰

---

### ğŸŸ¡ ä¸­å„ªå…ˆç´šå•é¡Œï¼ˆå»ºè­°ä¿®å¾©ï¼‰

#### 4. **æœªä½¿ç”¨çš„æª”æ¡ˆ/ä»£ç¢¼**
**å•é¡Œï¼š** æœ‰äº›æª”æ¡ˆå¯èƒ½å·²ç¶“ä¸å†ä½¿ç”¨
- `api-data-loader.js`ï¼šåœ¨ `index.html` ä¸­è¢«è¼‰å…¥ï¼ˆç¬¬2823è¡Œï¼‰ï¼Œä½†å¯¦éš›ä¸Šå‰ç«¯å·²ç¶“ç›´æ¥é€£æ¥ Supabaseï¼Œä¸éœ€è¦ API
- `related-links-loader.js`ï¼šå¯èƒ½æ˜¯èˆŠç‰ˆæœ¬ï¼Œéœ€è¦ç¢ºèªæ˜¯å¦é‚„åœ¨ä½¿ç”¨

**å½±éŸ¿ï¼š**
- å¢åŠ è¼‰å…¥æ™‚é–“
- å¯èƒ½é€ æˆæ··æ·†
- ä¸å¿…è¦çš„ç¶²è·¯è«‹æ±‚

**å»ºè­°ï¼š**
- ç¢ºèª `api-data-loader.js` æ˜¯å¦é‚„éœ€è¦ï¼ˆä½œç‚ºå‚™ç”¨ï¼‰
- å¦‚æœä¸éœ€è¦ï¼Œç§»é™¤ `index.html` ä¸­çš„å¼•ç”¨
- æª¢æŸ¥ `related-links-loader.js` æ˜¯å¦é‚„åœ¨ä½¿ç”¨

---

#### 5. **è¨»é‡‹èˆ‡å¯¦éš›è¡Œç‚ºä¸ä¸€è‡´**
**å•é¡Œï¼š** è¨»é‡‹èªªæ˜èˆ‡å¯¦éš›ä»£ç¢¼è¡Œç‚ºä¸ç¬¦
- `index.html` (ç¬¬2819è¡Œ)ï¼šè¨»é‡‹èªªã€Œå¾å¾Œç«¯ API è¼‰å…¥ã€ï¼Œä½†å¯¦éš›ä¸Šå·²ç¶“æ”¹ç‚ºç›´æ¥é€£æ¥ Supabase
- `property-detail.html` (ç¬¬460ã€464è¡Œ)ï¼šè¨»é‡‹èªªã€Œå¾å¾Œç«¯ API è¼‰å…¥ã€ï¼Œä½†å¯¦éš›ä¸Šå·²ç¶“æ”¹ç‚ºç›´æ¥é€£æ¥ Supabase

**å½±éŸ¿ï¼š**
- é€ æˆé–‹ç™¼è€…å›°æƒ‘
- ç¶­è­·æ™‚å¯èƒ½èª¤è§£ä»£ç¢¼è¡Œç‚º

**å»ºè­°ï¼š**
- æ›´æ–°æ‰€æœ‰ç›¸é—œè¨»é‡‹ï¼Œåæ˜ å¯¦éš›è¡Œç‚º
- ç¢ºä¿è¨»é‡‹èˆ‡ä»£ç¢¼ä¸€è‡´

---

#### 6. **property-detail.html æœªä½¿ç”¨çµ±ä¸€é…ç½®**
**å•é¡Œï¼š** `property-detail.html` é›–ç„¶è¼‰å…¥äº† `supabase-config.js`ï¼Œä½†æ²’æœ‰ä½¿ç”¨å®ƒ
- è¼‰å…¥äº† `supabase-config.js` (ç¬¬462è¡Œ)
- ä½†è‡ªå·±å®šç¾©äº† `SUPABASE_URL_VALUE` å’Œ `SUPABASE_ANON_KEY_VALUE` (ç¬¬469-470è¡Œ)
- æ²’æœ‰ä½¿ç”¨ `SUPABASE_CONFIG` æˆ– `createSupabaseClient()`

**å½±éŸ¿ï¼š**
- é…ç½®ä¸ä¸€è‡´
- ç„¡æ³•äº«å—çµ±ä¸€é…ç½®çš„å¥½è™•

**å»ºè­°ï¼š**
- ç§»é™¤ç¡¬ç·¨ç¢¼çš„é…ç½®
- ä½¿ç”¨ `SUPABASE_CONFIG.url` å’Œ `SUPABASE_CONFIG.anonKey`
- æˆ–ä½¿ç”¨ `createSupabaseClient()` å‡½æ•¸

---

#### 7. **property-admin-db.html æœªä½¿ç”¨çµ±ä¸€é…ç½®**
**å•é¡Œï¼š** `property-admin-db.html` æœ‰è‡ªå·±çš„ Supabase åˆå§‹åŒ–é‚è¼¯
- ç¬¬1747-1769è¡Œï¼š`initSupabase()` å‡½æ•¸å¾ localStorage è®€å–é…ç½®ï¼Œæœ‰ç¡¬ç·¨ç¢¼çš„é è¨­å€¼
- æ²’æœ‰ä½¿ç”¨ `supabase-config.js` çš„çµ±ä¸€é…ç½®

**å½±éŸ¿ï¼š**
- é…ç½®ä¾†æºä¸ä¸€è‡´
- ç¶­è­·å›°é›£

**å»ºè­°ï¼š**
- è¼‰å…¥ `supabase-config.js`
- ä½¿ç”¨ `createSupabaseClient()` æˆ–çµ±ä¸€çš„åˆå§‹åŒ–æ–¹å¼
- ä¿ç•™ localStorage ä½œç‚ºå¯é¸çš„è¦†è“‹æ©Ÿåˆ¶

---

### ğŸŸ¢ ä½å„ªå…ˆç´šå•é¡Œï¼ˆå¯é¸æ”¹é€²ï¼‰

#### 8. **éå¤šçš„ console.log**
**å•é¡Œï¼š** ä»£ç¢¼ä¸­æœ‰å¤§é‡ console.logï¼ˆ1008 å€‹åŒ¹é…ï¼‰
**å½±éŸ¿ï¼š**
- ç”Ÿç”¢ç’°å¢ƒå¯èƒ½é€ æˆæ•ˆèƒ½å½±éŸ¿
- æ§åˆ¶å°è¨Šæ¯éå¤š

**å»ºè­°ï¼š**
- ä½¿ç”¨ç’°å¢ƒè®Šæ•¸æ§åˆ¶æ—¥èªŒè¼¸å‡º
- æˆ–ä½¿ç”¨æ—¥èªŒç´šåˆ¥ï¼ˆdebug, info, warn, errorï¼‰
- ç”Ÿç”¢ç’°å¢ƒç§»é™¤ debug æ—¥èªŒ

---

#### 9. **éŒ¯èª¤è™•ç†å¯ä»¥æ›´å®Œå–„**
**å•é¡Œï¼š** æŸäº›åœ°æ–¹å¯èƒ½ç¼ºå°‘éŒ¯èª¤è™•ç†
**å»ºè­°ï¼š**
- æª¢æŸ¥æ‰€æœ‰ async å‡½æ•¸æ˜¯å¦æœ‰ try-catch
- æª¢æŸ¥æ‰€æœ‰ Supabase æŸ¥è©¢æ˜¯å¦æœ‰éŒ¯èª¤è™•ç†
- çµ±ä¸€éŒ¯èª¤è™•ç†æ ¼å¼

---

#### 10. **ç¨‹å¼ç¢¼çµ„ç¹”å¯ä»¥æ›´æ¨¡çµ„åŒ–**
**å•é¡Œï¼š** æŸäº›åŠŸèƒ½å¯èƒ½å¯ä»¥é€²ä¸€æ­¥æ¨¡çµ„åŒ–
**å»ºè­°ï¼š**
- è€ƒæ…®å°‡ `formatAddressForDisplay` ç§»åˆ°æ¨¡çµ„ä¸­
- è€ƒæ…®å°‡ Supabase å®¢æˆ¶ç«¯åˆå§‹åŒ–é‚è¼¯çµ±ä¸€
- è€ƒæ…®å°‡é‡è¤‡çš„è³‡æ–™æ ¼å¼åŒ–é‚è¼¯çµ±ä¸€

---

## ğŸ“ ä¿®å¾©å„ªå…ˆé †åºå»ºè­°

### ç¬¬ä¸€éšæ®µï¼ˆç«‹å³ä¿®å¾©ï¼‰
1. âœ… çµ±ä¸€ Supabase é…ç½®ï¼ˆç§»é™¤æ‰€æœ‰ç¡¬ç·¨ç¢¼ï¼‰
2. âœ… çµ±ä¸€ Supabase å®¢æˆ¶ç«¯åˆå§‹åŒ–ï¼ˆä½¿ç”¨å–®ä¾‹æ¨¡å¼ï¼‰
3. âœ… çµ±ä¸€ `formatAddressForDisplay` å‡½æ•¸ï¼ˆç§»é™¤é‡è¤‡å®šç¾©ï¼‰

### ç¬¬äºŒéšæ®µï¼ˆè¿‘æœŸä¿®å¾©ï¼‰
4. âœ… æ›´æ–°è¨»é‡‹ï¼Œç¢ºä¿èˆ‡å¯¦éš›è¡Œç‚ºä¸€è‡´
5. âœ… ç§»é™¤æˆ–ç¢ºèªæœªä½¿ç”¨çš„æª”æ¡ˆ
6. âœ… æ”¹é€²éŒ¯èª¤è™•ç†

### ç¬¬ä¸‰éšæ®µï¼ˆå¯é¸æ”¹é€²ï¼‰
7. âœ… å„ªåŒ– console.log ä½¿ç”¨
8. âœ… é€²ä¸€æ­¥æ¨¡çµ„åŒ–

---

## ğŸ”§ å…·é«”ä¿®å¾©å»ºè­°

### ä¿®å¾© 1ï¼šçµ±ä¸€ Supabase é…ç½®

**æª”æ¡ˆï¼š** `property-detail.html`
```javascript
// ç§»é™¤ï¼š
const SUPABASE_URL_VALUE = 'https://cnzqtuuegdqwkgvletaa.supabase.co';
const SUPABASE_ANON_KEY_VALUE = '...';

// æ”¹ç‚ºï¼š
// ç¢ºä¿ supabase-config.js å·²è¼‰å…¥
if (typeof SUPABASE_CONFIG === 'undefined') {
    console.error('âŒ SUPABASE_CONFIG æœªè¼‰å…¥');
}
```

**æª”æ¡ˆï¼š** `supabase-data-loader.js`
```javascript
// ç§»é™¤ï¼š
const SUPABASE_URL = '...';
const SUPABASE_ANON_KEY = '...';

// æ”¹ç‚ºï¼š
// ä½¿ç”¨ supabase-config.jsï¼ˆéœ€è¦ç¢ºä¿å·²è¼‰å…¥ï¼‰
if (typeof SUPABASE_CONFIG === 'undefined') {
    console.error('âŒ è«‹å…ˆè¼‰å…¥ supabase-config.js');
}
```

---

### ä¿®å¾© 2ï¼šçµ±ä¸€ Supabase å®¢æˆ¶ç«¯åˆå§‹åŒ–

**æª”æ¡ˆï¼š** `property-detail.html`
```javascript
// æ”¹ç‚ºï¼š
const supabaseClient = (() => {
    // æª¢æŸ¥æ˜¯å¦æœ‰å…¨åŸŸå®¢æˆ¶ç«¯
    if (typeof window.supabaseClient !== 'undefined' && window.supabaseClient) {
        return window.supabaseClient;
    }
    
    // ä½¿ç”¨çµ±ä¸€é…ç½®å‰µå»º
    if (typeof createSupabaseClient === 'function') {
        const client = createSupabaseClient();
        window.supabaseClient = client;
        return client;
    }
    
    // å‚™ç”¨ï¼šç›´æ¥å‰µå»º
    if (typeof SUPABASE_CONFIG !== 'undefined') {
        const client = supabase.createClient(SUPABASE_CONFIG.url, SUPABASE_CONFIG.anonKey);
        window.supabaseClient = client;
        return client;
    }
    
    throw new Error('ç„¡æ³•åˆå§‹åŒ– Supabase å®¢æˆ¶ç«¯');
})();
```

---

### ä¿®å¾© 3ï¼šçµ±ä¸€ formatAddressForDisplay å‡½æ•¸

**å»ºè­°ï¼š** å‰µå»º `modules/utils/address-formatter.js`
```javascript
// å°‡ formatAddressForDisplay ç§»åˆ°é€™è£¡
// æ‰€æœ‰æª”æ¡ˆçµ±ä¸€å¼•ç”¨
```

**æª”æ¡ˆä¿®æ”¹ï¼š**
- `property-detail.html`ï¼šç§»é™¤æœ¬åœ°å®šç¾©ï¼Œä½¿ç”¨æ¨¡çµ„
- `supabase-data-loader.js`ï¼šç§»é™¤æœ¬åœ°å®šç¾©ï¼Œä½¿ç”¨æ¨¡çµ„
- å…¶ä»–æª”æ¡ˆï¼šçµ±ä¸€ä½¿ç”¨æ¨¡çµ„ç‰ˆæœ¬

---

### ä¿®å¾© 4ï¼šæ›´æ–°è¨»é‡‹

**æª”æ¡ˆï¼š** `index.html` (ç¬¬2819è¡Œ)
```html
<!-- ç›¸é—œé€£çµå‰ç«¯é¡¯ç¤ºæ¨¡çµ„ï¼ˆç›´æ¥é€£æ¥ Supabaseï¼‰ -->
```

**æª”æ¡ˆï¼š** `property-detail.html` (ç¬¬460ã€464è¡Œ)
```html
<!-- ç›¸é—œé€£çµå‰ç«¯é¡¯ç¤ºæ¨¡çµ„ï¼ˆç›´æ¥é€£æ¥ Supabaseï¼‰ -->
```

---

### ä¿®å¾© 5ï¼šç§»é™¤æœªä½¿ç”¨çš„æª”æ¡ˆå¼•ç”¨

**æª”æ¡ˆï¼š** `index.html` (ç¬¬2823è¡Œ)
```html
<!-- å¯é¸ï¼šç§»é™¤æˆ–è¨»è§£æ‰ï¼Œå› ç‚ºå·²ç¶“ç›´æ¥ä½¿ç”¨ Supabase -->
<!-- <script src="api-data-loader.js"></script> -->
```

---

#### 11. **property-admin-db.html ä½¿ç”¨ localStorage å„²å­˜é…ç½®**
**å•é¡Œï¼š** `property-admin-db.html` ä½¿ç”¨ localStorage å„²å­˜ Supabase é…ç½®ï¼Œä½†åŒæ™‚æœ‰ç¡¬ç·¨ç¢¼é è¨­å€¼
- ç¬¬1748-1749è¡Œï¼šå¾ localStorage è®€å–ï¼Œä½†æœ‰ç¡¬ç·¨ç¢¼é è¨­å€¼
- ç¬¬1839-1840è¡Œï¼šå„²å­˜åˆ° localStorage

**å½±éŸ¿ï¼š**
- é…ç½®ä¾†æºæ··äº‚ï¼ˆlocalStorage vs ç¡¬ç·¨ç¢¼ vs supabase-config.jsï¼‰
- å¯èƒ½é€ æˆä¸ä¸€è‡´

**å»ºè­°ï¼š**
- å„ªå…ˆä½¿ç”¨ `supabase-config.js` çš„çµ±ä¸€é…ç½®
- localStorage ä½œç‚ºå¯é¸çš„è¦†è“‹æ©Ÿåˆ¶ï¼ˆç”¨æ–¼é–‹ç™¼æ¸¬è©¦ï¼‰
- æ˜ç¢ºé…ç½®å„ªå…ˆé †åºï¼šsupabase-config.js > localStorage > ç¡¬ç·¨ç¢¼é è¨­å€¼

---

#### 12. **escapeHtml å‡½æ•¸é‡è¤‡å®šç¾©**
**å•é¡Œï¼š** `escapeHtml` å‡½æ•¸åœ¨å¤šå€‹æª”æ¡ˆä¸­é‡è¤‡å®šç¾©
- `modules/related-links/backend.js` (ç¬¬263-268è¡Œ)
- `related-links-loader.js` (ç¬¬308-314è¡Œ)
- å¯èƒ½åœ¨å…¶ä»–æª”æ¡ˆä¸­ä¹Ÿæœ‰

**å»ºè­°ï¼š**
- çµ±ä¸€ç§»åˆ°å·¥å…·æ¨¡çµ„
- æ‰€æœ‰æª”æ¡ˆçµ±ä¸€å¼•ç”¨

---

#### 13. **property-detail.html å·²è¼‰å…¥ Supabase SDKï¼ˆç„¡å•é¡Œï¼‰**
**ç‹€æ…‹ï¼š** âœ… å·²æ­£ç¢ºè¼‰å…¥
- ç¬¬457è¡Œï¼šå·²è¼‰å…¥ Supabase SDK
- ç¬¬462è¡Œï¼šå·²è¼‰å…¥ `supabase-config.js`
- ä½†ç¬¬469-470è¡Œä»ä½¿ç”¨ç¡¬ç·¨ç¢¼é…ç½®ï¼Œæœªä½¿ç”¨çµ±ä¸€é…ç½®

**å»ºè­°ï¼š**
- ç§»é™¤ç¡¬ç·¨ç¢¼é…ç½®ï¼Œä½¿ç”¨ `SUPABASE_CONFIG`

---

#### 14. **server.js ä¸­çš„ Supabase é…ç½®**
**å•é¡Œï¼š** `server.js` æ˜¯ Node.js å¾Œç«¯ï¼Œä¸æ‡‰è©²ä½¿ç”¨ç€è¦½å™¨çš„ `supabase-config.js`
- ç¬¬16-17è¡Œï¼šç¡¬ç·¨ç¢¼é…ç½®ï¼ˆé€™æ˜¯åˆç†çš„ï¼Œå› ç‚ºæ˜¯ Node.js ç’°å¢ƒï¼‰
- ä½†å¯ä»¥è€ƒæ…®ä½¿ç”¨ç’°å¢ƒè®Šæ•¸

**å»ºè­°ï¼š**
- ä½¿ç”¨ç’°å¢ƒè®Šæ•¸ï¼ˆ`process.env.SUPABASE_URL`ï¼‰
- æä¾› `.env.example` æª”æ¡ˆä½œç‚ºç¯„ä¾‹
- ä¿æŒèˆ‡å‰ç«¯é…ç½®ä¸€è‡´ï¼ˆä½†ä¾†æºä¸åŒï¼‰

---

#### 15. **é‡è¤‡çš„è¨»é‡‹è¡Œ**
**å•é¡Œï¼š** `property-detail.html` ä¸­æœ‰é‡è¤‡çš„è¨»é‡‹
- ç¬¬460è¡Œå’Œç¬¬464è¡Œéƒ½æ˜¯ã€Œç›¸é—œé€£çµå‰ç«¯é¡¯ç¤ºæ¨¡çµ„ï¼ˆå¾å¾Œç«¯ API è¼‰å…¥ï¼‰ã€

**å»ºè­°ï¼š**
- ç§»é™¤é‡è¤‡è¨»é‡‹
- æ›´æ–°ç‚ºæ­£ç¢ºçš„æè¿°

---

## âœ… æª¢æŸ¥æ¸…å–®

- [ ] çµ±ä¸€æ‰€æœ‰ Supabase é…ç½®åˆ° `supabase-config.js`
- [ ] çµ±ä¸€æ‰€æœ‰ Supabase å®¢æˆ¶ç«¯åˆå§‹åŒ–ï¼ˆä½¿ç”¨å–®ä¾‹æ¨¡å¼ï¼‰
- [ ] çµ±ä¸€ `formatAddressForDisplay` å‡½æ•¸ï¼ˆç§»é™¤é‡è¤‡å®šç¾©ï¼‰
- [ ] æ›´æ–°æ‰€æœ‰è¨»é‡‹ï¼Œç¢ºä¿èˆ‡å¯¦éš›è¡Œç‚ºä¸€è‡´
- [ ] ç¢ºèªä¸¦ç§»é™¤æœªä½¿ç”¨çš„æª”æ¡ˆå¼•ç”¨
- [ ] æ”¹é€²éŒ¯èª¤è™•ç†ï¼ˆç¢ºä¿æ‰€æœ‰ async å‡½æ•¸éƒ½æœ‰ try-catchï¼‰
- [ ] å„ªåŒ– console.log ä½¿ç”¨ï¼ˆå¯é¸ï¼‰
- [ ] é€²ä¸€æ­¥æ¨¡çµ„åŒ–ï¼ˆå¯é¸ï¼‰

---

## ğŸ“Š çµ±è¨ˆè³‡è¨Š

- **ç¸½æª”æ¡ˆæ•¸ï¼š** ç´„ 50+ å€‹æª”æ¡ˆ
- **ä¸»è¦å•é¡Œï¼š** 15 å€‹å•é¡Œï¼ˆ3 å€‹é«˜å„ªå…ˆç´šï¼Œ7 å€‹ä¸­å„ªå…ˆç´šï¼Œ5 å€‹ä½å„ªå…ˆç´šï¼‰
- **å»ºè­°ä¿®å¾©æ™‚é–“ï¼š** 2-3 å°æ™‚
- **å½±éŸ¿ç¯„åœï¼š** é…ç½®ç®¡ç†ã€ä»£ç¢¼ä¸€è‡´æ€§ã€ç¶­è­·æ€§ã€å®‰å…¨æ€§

---

## ğŸ”’ å®‰å…¨æ€§æª¢æŸ¥

### âœ… å·²å¯¦æ–½çš„å®‰å…¨æªæ–½
- âœ… ä½¿ç”¨ `escapeHtml` å‡½æ•¸é˜²æ­¢ XSSï¼ˆåœ¨å¾Œå°ç®¡ç†ä¸­ä½¿ç”¨ï¼‰
- âœ… Supabase ä½¿ç”¨ Anon Keyï¼ˆå…¬é–‹é‡‘é‘°ï¼Œç›¸å°å®‰å…¨ï¼‰
- âœ… ä½¿ç”¨ Supabase RLSï¼ˆRow Level Securityï¼‰ä¿è­·è³‡æ–™

### âš ï¸ éœ€è¦æ³¨æ„çš„å®‰å…¨å•é¡Œ
1. **ç¡¬ç·¨ç¢¼çš„ API Key**
   - é›–ç„¶æ˜¯ Anon Keyï¼ˆå…¬é–‹é‡‘é‘°ï¼‰ï¼Œä½†å»ºè­°ä½¿ç”¨ç’°å¢ƒè®Šæ•¸
   - ç”Ÿç”¢ç’°å¢ƒæ‡‰è©²ä½¿ç”¨ç’°å¢ƒè®Šæ•¸

2. **CORS è¨­å®šéæ–¼å¯¬é¬†**
   - `server.js` ä¸­ `origin: '*'` å…è¨±æ‰€æœ‰ä¾†æº
   - ç”Ÿç”¢ç’°å¢ƒæ‡‰è©²é™åˆ¶ç‰¹å®šç¶²åŸŸ

---

## ğŸ“‹ æª”æ¡ˆè¼‰å…¥é †åºæª¢æŸ¥

### index.html
âœ… è¼‰å…¥é †åºæ­£ç¢ºï¼š
1. Supabase SDK
2. supabase-data-loader.js
3. supabase-config.js
4. modules/related-links/frontend.js
5. api-data-loader.jsï¼ˆå¯é¸ç§»é™¤ï¼‰
6. å…¶ä»–æ¨¡çµ„

### property-detail.html
âœ… è¼‰å…¥é †åºæ­£ç¢ºï¼š
1. Supabase SDK (ç¬¬457è¡Œ)
2. supabase-config.js (ç¬¬462è¡Œ)
3. modules/related-links/frontend.js (ç¬¬465è¡Œ)
âš ï¸ ä½†æœªä½¿ç”¨çµ±ä¸€é…ç½®ï¼ˆç¬¬469-470è¡Œç¡¬ç·¨ç¢¼ï¼‰

---

## ğŸ¨ ç¨‹å¼ç¢¼å“è³ªå»ºè­°

### 1. **çµ±ä¸€éŒ¯èª¤è™•ç†æ ¼å¼**
å»ºè­°å‰µå»ºçµ±ä¸€çš„éŒ¯èª¤è™•ç†å‡½æ•¸ï¼š
```javascript
function handleError(error, context) {
    console.error(`âŒ ${context}:`, error);
    // çµ±ä¸€çš„éŒ¯èª¤è™•ç†é‚è¼¯
}
```

### 2. **çµ±ä¸€è³‡æ–™é©—è­‰**
å»ºè­°ä½¿ç”¨ `modules/data-entry/manager.js` ä¸­çš„é©—è­‰å‡½æ•¸ï¼š
- ç¢ºä¿æ‰€æœ‰è³‡æ–™è¼¸å…¥éƒ½ç¶“éé©—è­‰
- çµ±ä¸€é©—è­‰è¦å‰‡

### 3. **çµ±ä¸€è³‡æ–™æ ¼å¼åŒ–**
å»ºè­°çµ±ä¸€ä½¿ç”¨ `modules/data-entry/manager.js` ä¸­çš„æ ¼å¼åŒ–å‡½æ•¸ï¼š
- `formatLayout()`
- `formatArea()`
- `formatAge()`

---

## ğŸ“Š çµ±è¨ˆè³‡è¨Š

- **ç¸½æª”æ¡ˆæ•¸ï¼š** ç´„ 50+ å€‹æª”æ¡ˆ
- **ä¸»è¦å•é¡Œï¼š** 15 å€‹å•é¡Œï¼ˆ3 å€‹é«˜å„ªå…ˆç´šï¼Œ7 å€‹ä¸­å„ªå…ˆç´šï¼Œ5 å€‹ä½å„ªå…ˆç´šï¼‰
- **å»ºè­°ä¿®å¾©æ™‚é–“ï¼š** 2-3 å°æ™‚
- **å½±éŸ¿ç¯„åœï¼š** é…ç½®ç®¡ç†ã€ä»£ç¢¼ä¸€è‡´æ€§ã€ç¶­è­·æ€§ã€å®‰å…¨æ€§

---

## ğŸ¯ ä¿®å¾©å¾Œçš„é æœŸæ•ˆæœ

1. **é…ç½®çµ±ä¸€ï¼š** æ‰€æœ‰ Supabase é…ç½®é›†ä¸­åœ¨ä¸€å€‹æª”æ¡ˆ
2. **ä»£ç¢¼ä¸€è‡´æ€§ï¼š** æ‰€æœ‰æª”æ¡ˆä½¿ç”¨ç›¸åŒçš„åˆå§‹åŒ–æ–¹å¼
3. **ç¶­è­·æ€§æå‡ï¼š** æ¸›å°‘é‡è¤‡ä»£ç¢¼ï¼Œæ˜“æ–¼ç¶­è­·
4. **æ•ˆèƒ½å„ªåŒ–ï¼š** é¿å…å¤šå€‹ Supabase å®¢æˆ¶ç«¯å¯¦ä¾‹
5. **å¯è®€æ€§æå‡ï¼š** è¨»é‡‹æº–ç¢ºåæ˜ å¯¦éš›è¡Œç‚º
